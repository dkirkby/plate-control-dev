# Template file for positioner configs.

[DEFAULT]
SERIAL_ID  = 'serial'  # string,     unique serial id number from manufacturing
BUS_ID     = 0         # int,        id number on the CAN bus
DEVICE_ID  = 'device'  # string,     location id on the petal or plate
PETAL_ID   = 'petal'   # string,     id of the petal or plate it is mounted on
LENGTH_R1  = 3.0       # mm,         distance from central axis to eccentric ("theta arm")
LENGTH_R2  = 3.0       # mm,         distance from eccentric axis to fiber ("phi arm")
POLYN_T0   = 0.0       # deg,        theta calibrated offset, where Tobserver = T0 + T1*Tshaft + T2*Tshaft^2
POLYN_T1   = 1.0       # deg/deg,    theta linear term calibration (1.0 means perfectly matches nominal gear ratio)
POLYN_T2   = 0.0       # deg/deg^2,  theta quadratic term calibration
POLYN_P0   = 0.0       # deg,        phi calibrated offset, where Pobserver = P0 + P1*Pshaft + P2*Pshaft^2
POLYN_P1   = 1.0       # deg/deg,    theta linear term calibration (1.0 means perfectly matches nominal gear ratio)
POLYN_P2   = 0.0       # deg/deg^2,  phi quadratic term calibration
POLYN_X0   = 0.0       # mm,         calibrated offset of central axis in x
POLYN_Y0   = 0.0       # mm,         calibrated offset of central axis in y
PHYSICAL_RANGE_T = 380.0    # deg, theta range of travel  
PHYSICAL_RANGE_P = 200.0    # deg, phi range of travel
BACKLASH = 3.0              # deg  backlash removal distance
PRINCIPLE_HARDSTOP_DIR_T = -1            # int, +1, -1, or 0. +1 means use hardstop at max of theta range, -1 means use hardstop at min of range, 0 means no hardstop exists
PRINCIPLE_HARDSTOP_DIR_P = +1            # int, +1, -1, or 0. +1 means use hardstop at max of phi range, -1 means use hardstop at min of range, 0 means no hardstop exists
PRINCIPLE_HARDSTOP_CLEARANCE_T   = 10.0  # float, minimum distance in deg to stay clear of theta principle hardstop
SECONDARY_HARDSTOP_CLEARANCE_T   =  5.0  # float, minimum distance in deg to stay clear of theta secondary hardstop
PRINCIPLE_HARDSTOP_CLEARANCE_P   =  5.0  # float, minimum distance in deg to stay clear of phi principle hardstop
SECONDARY_HARDSTOP_CLEARANCE_P   =  5.0  # float, minimum distance in deg to stay clear of phi secondary hardstop
LIMIT_SEEK_EXCEED_RANGE_FACTOR   =  1.3  # float, factor beyond nominal range to use when seeking hardstops
BACKLASH_REMOVAL_BACKUP_FRACTION =  0.5  # float, when move direction == backlash_removal_direction, undershoot by this fraction of BACKLASH, then backup by (1-fraction)*BACKLASH, then advance by BACKLASH
ALLOW_EXCEED_LIMITS       = False    # bool, flag to allow positioner to go past software limits or not. exercise some caution if setting this true
SHOULD_DEBOUNCE_HARDSTOPS = True     # bool, flag to turn on/off automatic debounce from hardstops. typically leave on for homing, but turn off if need to measure full physical range of travel
CURR_SPIN_UP_DOWN = 100              # int, 0-100, spin up / spin down current
CURR_CRUISE       =  70              # int, 0-100, cruise current
CURR_CREEP        =  70              # int, 0-100, creep current
CURR_HOLD         =   0              # int, 0-100 can be set to zero to completely power off theta motors after moving
SPINUPDOWN_DISTANCE = 628.2          # float, distance at the motor shaft in deg over which to spin up to cruise speed or down from cruise speed
# SPINUPDOWN_DISTANCE WILL IN FUTURE BE CHANGED TO SPINUPDOWN_PERIOD, AS SHOWN BELOW...
# SPINUPDOWN_PERIOD = 12             # int, number of 55 us periods to repeat each displacement during spin up to cruise speed or spin down from cruise speed. a higher value causes slower acceleration, over a longer travel distance
CREEP_PERIOD = 2                     # int, number of timer intervals corresponding to a creep step
ONLY_CREEP  = False                  # bool, if true disable cruising speed
FINAL_CREEP_ON  = True               # bool, if true do a finishing creep move after a cruise
BACKLASH_REMOVAL_ON = True           # boolean, if true do an antibacklash sequence at end of a move
NOM_FINAL_CREEP_DIST  = 180.0        # float, nominal distance in deg to creep after a cruise
ANTIBACKLASH_FINAL_MOVE_DIR_T =  -1  # +1 or -1, direction to do the last move of any antibacklash sequence on theta axis
ANTIBACKLASH_FINAL_MOVE_DIR_P =  +1  # +1 or -1, direction to do the last move of any antibacklash sequence on phi axis
CREEP_TO_LIMITS = False              # bool, if true, when approaching hardstops only creep up on them
MOTOR_CCW_DIR_T = 1  # +1 or -1, defining as-wired motor's counter-clockwise direction
MOTOR_CCW_DIR_P = 1  # +1 or -1, defining as-wired motor's counter-clockwise direction
MOTOR_ID_T = 1       # int, defining as-wired solder pads to which theta motor is connected
MOTOR_ID_P = 0       # int, defining as-wired solder pads to which phi motor is connected
GEAR_T = 'namiki' # gear type on theta axis
GEAR_P = 'namiki' # gear type on phi axis

